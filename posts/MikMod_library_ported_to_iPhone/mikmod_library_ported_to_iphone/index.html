<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>MikMod library ported to iPhone | blog-dump</title>
<link href="../../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/style.css" rel="stylesheet" media="screen" type="text/css">
<link href="../../../assets/css/style-print.css" rel="stylesheet" media="print" type="text/css">
<link href="../../../assets/css/code_blocks/friendly.css" media="screen" rel="stylesheet">
<link href="../../../assets/css/code_blocks/bw.css" media="print" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://dciabrin.net/posts/MikMod_library_ported_to_iPhone/mikmod_library_ported_to_iphone/">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Damien Ciabrini">
<link rel="prev" href="../../Hello_World_/hello_world_/" title="Hello World!" type="text/html">
<link rel="next" href="../../Hello_MikMod_/hello_mikmod_/" title="Hello MikMod!" type="text/html">
<meta property="og:site_name" content="blog-dump">
<meta property="og:title" content="MikMod library ported to iPhone">
<meta property="og:url" content="https://dciabrin.net/posts/MikMod_library_ported_to_iPhone/mikmod_library_ported_to_iphone/">
<meta property="og:description" content="I've always been a big fan of old skool computer music, like chiptunes
or demoscene music. Perhaps because they remind me the Good Old Days
(tm) of my Amiga. Or perhaps for
the same reason I like demo">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2008-06-27T23:18:00+02:00">
<meta property="article:tag" content="apple">
<meta property="article:tag" content="apple-kbd">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../../">

            <span id="blog-title">blog-dump</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container-fluid" id="content" role="main">
  <!-- <div class="row justify-content-center"> -->
  <!--   <div class="col-lg-10 col-md-12"> -->
      <!-- <div class="body-content"> -->
        <!--Body content-->
        
<div class="row justify-content-center">
<div class="col-lg-10 col-md-12">
<div class="body-content">
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">MikMod library ported to iPhone</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Damien Ciabrini
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2008-06-27T23:18:00+02:00" itemprop="datePublished" title="2008-06-27 23:18">2008-06-27 23:18</time></a>
            </p>
            
        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I've always been a big fan of old skool computer music, like chiptunes
or demoscene music. Perhaps because they remind me the Good Old Days
(tm) of my <a href="http://en.wikipedia.org/wiki/Amiga">Amiga</a>. Or perhaps for
the same reason I like <a href="http://pouet.net/">demoscene</a>: real-time
computer art! Because it's definitely cool, I've decided to port MikMod
to the iPhone! We'll see later if it might be useful to someone else :)</p>
<!-- TEASER_END -->

<h2>Compiling libmikmod</h2>
<p>Here are the steps to follow to build libmikmod for your iPhone or iPod Touch. First of all, make sure that
you have the necessary header file from Apple, namely <code>AudioQueue.h</code>. This file is part of the AudioQueue
framework, which is available in the <a href="http://developer.apple.com/tools/download">MacOS X 10.5 SDK</a>. This means
that the official iPhone SDK is not required. Then, download the latest
<a href="http://mikmod.raphnet.net/files/libmikmod-3.2.0-beta2.tar.gz">libmikmod-3.2.0-beta2</a> available on the <a href="http://mikmod.raphnet.net/">MikMod
homepage</a>, as well as <a href="http://damien.ciabrini.free.fr/pub/mikmod-iphone/iphone-drv-mikmod-3.2.0-beta2.patch.gz">this patch for iPhone
support</a>.  For
simplicity, let's consider that both files will be downloaded in the same directory. Once you have them,
extract the archive and apply the patch:</p>
<div class="code"><pre class="code literal-block"><span class="go">tar -zxf libmikmod-3.2.0-beta2.tar.gz</span>
<span class="go">cd libmikmod-3.2.0-beta2</span>
<span class="go">gunzip -cd ../iphone-drv-mikmod-3.2.0-beta2.patch.gz | patch -p1</span>
</pre></div>

<p>Among other things, the patch modifies various Makefiles and the
configure script, so we have to cleanly regenerate all the
autotool-related files:</p>
<div class="code"><pre class="code literal-block"><span class="go">aclocal</span>
<span class="go">automake</span>
<span class="go">autoconf</span>
</pre></div>

<p>Now let's set up the necessary environment variables to configure and
build libmikmod. First, where to find the AudioQueue header and where to
install libmikmod:</p>
<div class="code"><pre class="code literal-block"><span class="go">export AQDIR=$HOME/local/audioqueue</span>
<span class="go">export MMDIR=$HOME/local/mikmod-iphone</span>
</pre></div>

<p>Make sure you are using absolute paths for the variables above. Then,
let's set up some compilation flags and name the tools we'll use from
the iPhone toolchain:</p>
<div class="code"><pre class="code literal-block"><span class="go">export CFLAGS="-I$AQDIR -DAVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER="</span>
<span class="go">export CPPFLAGS="$CFLAGS"</span>
<span class="go">export LDFLAGS="-framework AudioToolbox"</span>
<span class="go">export CC=arm-apple-darwin-gcc</span>
<span class="go">export RANLIB=arm-apple-darwin-ranlib</span>
</pre></div>

<p>Okay, now it's time to let configure do its job:</p>
<div class="code"><pre class="code literal-block"><span class="go">./configure --enable-iphone --host=arm-apple-darwin --disable-oss --disable-esd --prefix=$MMDIR</span>
</pre></div>

<p>We're almost done! But there's still a little quirk that must be
addressed. The project is configured to build shared libraries, which
for some reason refuse to link with the version of the open-source
iPhone toolchain I use. To overcome this problem, you just need to patch
the generated libtool configuration. Knowing no clever means to do so, I
propose something like:</p>
<div class="code"><pre class="code literal-block"><span class="go">sed -r -i 's/^(allow_undefined_flag.*)"/\1 -Wl,-read_only_relocs,suppress"/' libtool</span>
</pre></div>

<p>Phew, now we're done! Just type:</p>
<div class="code"><pre class="code literal-block"><span class="go">make CFLAGS="$CFLAGS"</span>
<span class="go">make install</span>
</pre></div>

<p>And voila! a fresh libmikmod with support for your beloved iPhone or
iPod Touch! Oh, by the way: the library comes in both static and dynamic
flavor, so it should be pretty usable. Of course, the obligatory example
will follow soon :P
<strong>EDIT:</strong> the link to the patch was pointing to a plain file instead of a gzip one,
fixed!</p>
    </div>

<!-- <nav> -->
<!--           <ul itemprop="keywords" class="tags">
            <li><a class="tag p-category" href="/categories/apple/" rel="tag">apple</a></li>
            <li><a class="tag p-category" href="/categories/apple-kbd/" rel="tag">apple-kbd</a></li>
        </ul>
 -->
<!-- </nav> -->
    
    
    
</article>
</div>
</div>
</div>
        <!--End of body content-->
      <!-- </div> -->
  <!--   </div> -->
  <!-- </div> -->
  <hr class="d-print-none">
<nav class="nav-articles d-print-none row justify-content-center"><div class="col-lg-10 col-md-12">
    <div class="row justify-content-center">
        <div class="col newer-article text-left">
            <div>Newer Post</div>
            <a href="../../Hello_MikMod_/hello_mikmod_/" rel="next" title="Hello MikMod!">Hello MikMod!</a>
        </div>
        
        <div class="col text-center">
        </div>
        <div class="col older-article text-right">
            <div>Older Post</div>
            <a href="../../Hello_World_/hello_world_/" rel="prev" title="Hello World!">Hello World!</a>
        </div>
    </div>
    </div>
</nav>
</div>
        <footer id="footer" class="d-print-none"><div class="container-fluid">
            <div class="row justify-content-center">
               <div class="col-lg-10 col-md-12">
                 <p class="text-center copyright text-muted">Contents © 2025         <a href="mailto:damien.ciabrini@gmail.com">Damien Ciabrini</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
                 
              </div>
            </div>
          </div>
        </footer><script src="../../../assets/js/jquery.min.js"></script><script src="../../../assets/js/popper.min.js"></script><script src="../../../assets/js/bootstrap.min.js"></script><script src="../../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
